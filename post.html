<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading... - LinkShare</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.x.x/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.x.x/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <a href="/" class="nav-brand">
            <img src="/linkshare-favicon.png" alt="LinkShare Logo" class="logo">
            <span>LinkShare</span>
        </a>
        <ul class="nav-links">
            <li><a href="/">Home</a></li>
            <li><a href="/add-group">Add Group</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/contact">Contact</a></li>
        </ul>
    </nav>

    <!-- Dynamic Content Section -->
    <div id="post-content" class="post-container">
        <div class="loading">Loading...</div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <div class="logo-container">
                    <img src="/linkshare-favicon.png" alt="LinkShare Logo" class="logo">
                    <h3>LinkShare</h3>
                </div>
                <div class="footer-tagline">
                    <p>Share and discover amazing WhatsApp groups links</p>
                </div>
            </div>
            <div class="footer-links">
                <a href="/">Home</a>
                <a href="/about">About</a>
                <a href="/privacy">Privacy</a>
                <a href="/contact">Contact</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 LinkShare. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Initialize Firebase
        const firebaseConfig = {
            // Your Firebase config here
            apiKey: "your-api-key",
            authDomain: "your-auth-domain",
            projectId: "your-project-id",
            storageBucket: "your-storage-bucket",
            messagingSenderId: "your-messaging-sender-id",
            appId: "your-app-id"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Get post slug from URL
        const slug = window.location.pathname.split('/')[1];

        // Load post content
        async function loadPost() {
            try {
                const querySnapshot = await db.collection('posts')
                    .where('slug', '==', slug)
                    .limit(1)
                    .get();

                if (!querySnapshot.empty) {
                    const post = querySnapshot.docs[0].data();
                    
                    // Update page title
                    document.title = `${post.title} - LinkShare`;

                    // Create HTML for groups
                    const groupsHtml = post.content.groups.map(group => `
                        <li>${group.name} - 
                            <a href="${group.link}">
                                <i class="fab fa-whatsapp"></i> Join Now
                            </a>
                        </li>
                    `).join('');

                    // Update page content
                    document.getElementById('post-content').innerHTML = `
                        <section class="group-section">
                            <h1>${post.title}</h1>
                            <div class="post-meta">
                                <span class="category">
                                    <i class="fas fa-tag"></i> ${post.category}
                                </span>
                                <span class="date">
                                    <i class="fas fa-calendar"></i> 
                                    ${new Date(post.dateAdded.toDate()).toLocaleDateString()}
                                </span>
                            </div>
                            <div class="post-description">
                                ${post.content.description}
                            </div>
                            <div class="group-content">
                                <ul>${groupsHtml}</ul>
                            </div>
                        </section>
                    `;

                    // Increment view count
                    await querySnapshot.docs[0].ref.update({
                        views: firebase.firestore.FieldValue.increment(1)
                    });
                } else {
                    // Post not found
                    window.location.href = '/404.html';
                }
            } catch (error) {
                console.error('Error loading post:', error);
                window.location.href = '/404.html';
            }
        }

        // Load post when page loads
        document.addEventListener('DOMContentLoaded', loadPost);
    </script>
</body>
</html> 