<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>M3U/M3U8 Playlist Viewer</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f4f4f4;
    }
    h2 {
      color: #333;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 20px;
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    .channel {
      background: white;
      margin: 10px 0;
      padding: 10px;
      border-left: 5px solid #007bff;
    }
    .logo {
      max-height: 30px;
      vertical-align: middle;
      margin-right: 10px;
    }
    .url {
      color: #555;
      font-size: 0.9em;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <h2>M3U/M3U8 Playlist Viewer</h2>
  <input type="text" id="m3uUrl" placeholder="Paste M3U or M3U8 file URL here..." />
  <button onclick="loadPlaylist()">Load Playlist</button>

  <div id="playlistContainer"></div>

  <script>
    async function loadPlaylist() {
      const url = document.getElementById('m3uUrl').value.trim();
      const container = document.getElementById('playlistContainer');
      container.innerHTML = '';

      if (!url) {
        alert("Please enter a URL.");
        return;
      }

      try {
        const res = await fetch(url);
        const text = await res.text();

        const lines = text.split('\n');
        let currentInfo = '';
        lines.forEach(line => {
          line = line.trim();
          if (line.startsWith('#EXTINF')) {
            currentInfo = line;
          } else if (line && !line.startsWith('#')) {
            const nameMatch = currentInfo.match(/,(.*)$/);
            const logoMatch = currentInfo.match(/tvg-logo="([^"]+)"/);
            const channelName = nameMatch ? nameMatch[1] : 'Unknown';
            const logo = logoMatch ? `<img class="logo" src="${logoMatch[1]}" alt="logo"/>` : '';
            container.innerHTML += `
              <div class="channel">
                ${logo}<strong>${channelName}</strong><br>
                <div class="url">${line}</div>
              </div>
            `;
            currentInfo = '';
          }
        });

        if (container.innerHTML === '') {
          container.innerHTML = "<p>No valid channels found or it's a single stream link.</p>";
        }
      } catch (err) {
        container.innerHTML = `<p style="color:red;">Error loading playlist: ${err.message}</p>`;
      }
    }
  </script>
</body>
</html>
